<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Blog By ThinkPHP 3.0</title>
        
        <link href="__PUBLIC__/css/blog/style.css" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" href="__PUBLIC__/plugins/ztree/css/demo.css" type="text/css">
        <link rel="stylesheet" href="__PUBLIC__/plugins/ztree/css/zTreeStyle/zTreeStyle.css" type="text/css">
        <script type="text/javascript" src="__PUBLIC__/blog/js/jquery-2.2.4.js"></script>
        <script type="text/javascript" src="__PUBLIC__/plugins/ztree/js/jquery.ztree.core.js"></script>
        
        
        <script language="javascript" src="/tpdemo/ThinkPHP_3.0/Examples/Blog/Tpl/Public/js/common.js" /></script>
        <script type="text/javascript" src="/tpdemo/ThinkPHP_3.0/Examples/Public/Js/Base.js"></script>
        <script type="text/javascript" src="/tpdemo/ThinkPHP_3.0/Examples/Public/Js/prototype.js"></script>
        <script type="text/javascript" src="/tpdemo/ThinkPHP_3.0/Examples/Public/Js/mootools.js"></script>
        <script type="text/javascript" src="/tpdemo/ThinkPHP_3.0/Examples/Public/Js/Ajax/ThinkAjax.js"></script>
        <script type="text/javascript" src="/tpdemo/ThinkPHP_3.0/Examples/Public/Js/UbbEditor.js"></script>
        <script type="text/javascript" src="/tpdemo/ThinkPHP_3.0/Examples/Public/Js/Form/CheckForm.js"></script>
        <script language="JavaScript">
        <!--
    //指定当前组模块URL地址
        var URL = '/tpdemo/ThinkPHP_3.0/Examples/Blog/index.php/Blog';
        var APP = '/tpdemo/ThinkPHP_3.0/Examples/Blog/index.php';
        var PUBLIC = '/tpdemo/ThinkPHP_3.0/Examples/Public';
        ThinkAjax.updateTip = '<IMG SRC="__PUBLIC__/images/blog/loading2.gif" WIDTH="16" HEIGHT="16" BORDER="0" ALT="loading..." align="absmiddle"> 数据处理中...';
        //-->
    </script>
</head>

<body>
    <div id="header">
        <div id="innerHeader">
            <div id="blogLogo"></div>
            <div class="blog-header">
                <div class="blog-desc">ThinkPHP [ Blog示例程序]</div>
            </div>
            <div id="menu">
                <ul>
                    <li><a href="__APP__">日志首页</a></li>
                    <li><a href="{:U('Blog/add')}">撰写日志</a></li>
                    <li><a href="http://thinkphp.cn">官方网站</a></li>
                </ul>
            </div>
        </div>
    </div>
    <!--中间部分-->
    <div id="mainWrapper">
        <div id="sidebar" class="sidebar">
            <div id="innerSidebar">
                <div id="panelSearch" class="panel">
                    <div id="panelStats" class="panel">
                        <h5>统计数据</h5>
                        <div class="panel-content">
                            创建日期：<span style="color:#CC9933">2014-04-25</span>
                            <br /> 日志总数：
                            <span style="color:#CC9933">37</span>
                            <br /> 阅读总数：
                            <span style="color:#6699FF">0</span>
                            <br /> 评论总数：
                            <span style="color:#FF9900">0</span>
                            <br />
                        </div>
                    </div>
                    <h5>日志分类 </h5>
                    <div class="panel-content">
                        <ul id="category" class="ztree">
                            <li>
                                <div class="fLeft">
                                    <input TYPE="text" id="categoryName" class="text" NAME="name">
                                </div>
                                <input TYPE="button" value="增 加" class="submit hMargin small" onclick="addCategory()">
                                <br style="clear:both;float:auto" />
                            </li>
                           
                        </ul>
                    </div>
                </div>
                <div id="panelSearch" class="panel">
                    <h5>最新日志</h5>
                    <div class="panel-content">
                        <ul>
                            <li>
                                <img src="__PUBLIC__/images/blog/icon_ctb.gif" width="11" height="11" border="0" alt="" align="absmiddle" />
                                <a href="/tpdemo/ThinkPHP_3.0/Examples/Blog/index.php/Blog/show/id/37" title="tp笔记">tp笔记</a>
                                <sup style="color:silver;font-size:12px">[<span style="color:#3366CC">0</span> |<span style="color:#FF6600"> 0</span>]</sup>
                            </li>
                        </ul>
                    </div>
                </div>
                <div id="panelSearch" class="panel">
                    <h5>最新评论</h5>
                    <div class="panel-content">
                        <ul>
                        </ul>
                    </div>
                </div>
                <div id="panelSearch" class="panel">
                    <h5>标签云集 [ <a href="/tpdemo/ThinkPHP_3.0/Examples/Blog/index.php/Blog/tag/">更多</a> ]</h5>
                    <div class="panel-content">
                        <ul>
                            <li>
                                <a href="/tpdemo/ThinkPHP_3.0/Examples/Blog/index.php/Blog/tag/name/mysqldump">
                                    <span style="font-size:12px;color:#B375ED">mysqldump</span>
                                </a>&nbsp;&nbsp;
                            </li>
                        </ul>
                    </div>
                </div>
                <div id="panelSearch" class="panel">
                    <h5>日志归档</h5>
                    <div class="panel-content">
                        <ul>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div id="content" class="content">
            <div id="innerContent">
                <div class="announce text" >
                    <h4 style="color:#FF3300">
                        <img src="__PUBLIC__/images/blog/wav.gif" width="18" height="18" border="0" alt="" align="absmiddle" />
                        <div>简单的BLOG示例</div>
                    </h4> 
                    <h3>刘阿勇的博客，欢迎访问</h3>
                    <p>请按照下面步骤操作，增加分类、添加日志、增加评论。</p>
                </div>
                <div class="article-top">
                    <div class="view-mode">浏览模式: <a href="?mode=normal">普通</a> | <a href="?mode=list">列表</a></div>
                    <div class="pages">
                        分页 {$page}
                    </div>
                </div>
                {$list}
                <div class="article-bottom">
                    <div class="pages">
                        分页 {$page}
                    </div>
                </div>
            </div>
        </div>
        <script language="JavaScript">
        /*
         [{ id:'01', name:'n1', isParent :true},{ id:'02',name:'n2',isParent:false},{ id:'03', name:'n3',isParent:true},{ id:'04',name:'n4',  isParent:false}]
         autoParam:["id", "name=n", "level=lv"],
         */

        var setting = {
            async: {
                enable: true,
                //url:"../asyncData/getNodes.php",
                //url:"http://html.my/business/index.php/MangerSystem/Cate/ztree", // 存在ajax 跨域的问题
                // url:"http://php.my/plungs/ztree/zTree_v3-master/agency.php",
                url: "{:U('Cate/ztree')}",
                autoParam: ["id=pid", "level=lv"],
                otherParam: {
                    "otherParam": "zTreeAsyncTest"
                },
                dataFilter: filter
            }
        };

        function filter(treeId, parentNode, childNodes) {
            console.log(childNodes);
            if (!childNodes)
                return null;
            //for (var i=0, l=childNodes.length; i<l; i++) {
            //childNodes[i].name = childNodes[i].name.replace(/\.n/g, '.');
            //}
            return childNodes;
        }

        $(document).ready(function() {
            $.fn.zTree.init($("#category"), setting);
        });
        //-->
        function addCategory() {
            ThinkAjax.send('/tpdemo/ThinkPHP_3.0/Examples/Blog/index.php/Category/insert', 'ajax=1&title=' + $F('categoryName'), addComplete);
        }

        function addComplete(data, status) {
            if (status == 1) {
                $('category').innerHTML += '<li id="category_' + data.id + '">' +
                        '<img src="__PUBLIC__/images/blog/folder.gif" width="18" height="18" border="0" alt="" align="absmiddle">' +
                        '<a href="/tpdemo/ThinkPHP_3.0/Examples/Blog/index.php/Category/' + data.id + '">' + data.title + '</a> <span >(0)</span>' +
                        +'<img src="__PUBLIC__/images/blog/del.gif" width="20" height="20" border="0" style="cursor:pointer" alt="" onclick="delCategory(' + data.id + ')" align="absmiddle" />';
            }
        }

        function delCategory(id) {
            ThinkAjax.send('/tpdemo/ThinkPHP_3.0/Examples/Blog/index.php/Category/delete/', 'ajax=1&id=' + id, delComplete);
        }

        function delComplete(data, status) {
            if (status == 1) {
                $('category_' + data).style.display = 'none';
            }
        }
        </script>
    </div>
    <!-- 版权信息区域 -->
    <div id="footer" class="footer">
        <div id="innerFooter">
            Powered by ThinkPHP 3.0 | Template designed by <a target="_blank" href="http://www.topthink.com.cn">TopThink</a>
        </div>
    </div>
</body>
</html>
